<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zsh Terminal</title>
    <style>
        body {
            background-color: #1a1b26;
            color: #c0caf5;
            font-family: monospace;
            padding: 10px;
            margin: 0;
        }
        #terminal, #editor {
            width: 100%;
            height: calc(100vh - 20px);
            background-color: #1a1b26;
            color: #c0caf5;
            padding: 10px;
            border: 1px solid #3b4261;
            overflow-y: auto;
            box-sizing: border-box;
        }
        .prompt {
            color: #7aa2f7;
        }
        .output {
            color: #c0caf5;
            white-space: pre; /* Preserve whitespace for ASCII art */
        }
        .input-line {
            display: flex;
            flex-wrap: wrap;
        }
        .input-line .prompt {
            margin-right: 10px;
            flex: 1 0 auto;
        }
        .input-line input {
            background: none;
            border: none;
            color: #c0caf5;
            flex: 2 1 auto;
            font-family: monospace;
            outline: none;
            min-width: 100px;
        }
        #editor-input {
            width: 100%;
            height: 100%;
            background: none;
            border: none;
            color: #c0caf5;
            font-family: monospace;
            outline: none;
            resize: none;
            box-sizing: border-box;
        }

        /* Responsive design for mobile */
        @media (max-width: 600px) {
            .input-line {
                flex-direction: column;
            }
            .input-line .prompt {
                margin-right: 0;
                margin-bottom: 5px;
                width: 100%;
                text-align: left;
            }
            .input-line input {
                width: 100%;
                min-width: 0;
            }
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div class="output">Welcome to Zsh Terminal</div>
        <div class="input-line">
            <div class="prompt">user@zsh:~$</div>
            <input type="text" id="input" autofocus>
        </div>
    </div>

    <div id="editor">
        <textarea id="editor-input"></textarea>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const terminal = document.getElementById('terminal');
            const input = document.getElementById('input');
            const editor = document.getElementById('editor');
            const editorInput = document.getElementById('editor-input');
            let inEditor = false;

            const frames = [
`          _______
        //  ||\\ \\
       //___||_\\ \\
      ||  ___  || 
      || |___| || 
      ||_______|| 
      \\_________/
       \\_______/
      _______
      \\       \\__
       \\_______( o)__
        |        (    )__
        |         (__)
        |_________|
`,
`          _______
        //  ||\\ \\
       //___||_\\ \\
      ||  ___  || 
      || |___| || 
      ||_______|| 
      \\_________/
       \\_______/
      _______
      \\       \\__
       \\_______( o)_
        |       (    )_
        |        (__)
        |_________|
`,
`          _______
        //  ||\\ \\
       //___||_\\ \\
      ||  ___  || 
      || |___| || 
      ||_______|| 
      \\_________/
       \\_______/
      _______
      \\       \\__
       \\_______( o)_
        |       (    )_
        |        (__)
        |_________|
`
            ];

            let currentFrame = 0;

            function animateTyping() {
                const resultDiv = document.createElement('div');
                resultDiv.classList.add('output');
                resultDiv.textContent = frames[currentFrame];
                terminal.appendChild(resultDiv);
                terminal.scrollTop = terminal.scrollHeight;

                currentFrame = (currentFrame + 1) % frames.length;
            }

            input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    const command = input.value.trim();
                    processCommand(command);
                    input.value = '';
                }
            });

            editorInput.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' || (event.key === 'q' && event.shiftKey)) {
                    if (editorInput.value.trim().endsWith(':q')) {
                        exitEditor();
                    }
                }
            });

            function processCommand(command) {
                const outputDiv = document.createElement('div');
                outputDiv.classList.add('output');
                outputDiv.textContent = `user@zsh:~$ ${command}`;
                terminal.insertBefore(outputDiv, terminal.lastElementChild);

                let resultDiv;
                let result;

                switch (command) {
                    case 'whoami':
                        result = 'Caleb Bratton';
                        break;
                    case 'ls':
                        result = 'resume.txt';
                        break;
                    case 'sh bratton.sh':
                        resultDiv = document.createElement('div');
                        resultDiv.classList.add('output');
                        terminal.appendChild(resultDiv);
                        setInterval(animateTyping, 500);
                        return;
                    case 'vim resume.txt':
                        fetchResume();
                        return;
                    default:
                        result = `${command}: command not found`;
                }

                if (result) {
                    resultDiv = document.createElement('div');
                    resultDiv.classList.add('output');
                    resultDiv.textContent = result;
                    terminal.insertBefore(resultDiv, terminal.lastElementChild);
                    terminal.scrollTop = terminal.scrollHeight;
                }
            }

            function fetchResume() {
                fetch('resume.txt')
                    .then(response => response.text())
                    .then(text => openEditor(text))
                    .catch(error => {
                        const resultDiv = document.createElement('div');
                        resultDiv.classList.add('output');
                        resultDiv.textContent = `Error loading resume: ${error}`;
                        terminal.insertBefore(resultDiv, terminal.lastElementChild);
                    });
            }

            function openEditor(content) {
                editor.style.display = 'block';
                terminal.style.display = 'none';
                inEditor = true;
                editorInput.focus();
                editorInput.value = content.trim();
                editorInput.setSelectionRange(0, 0); // Place cursor at the beginning
            }

            function exitEditor() {
                editor.style.display = 'none';
                terminal.style.display = 'block';
                inEditor = false;
                input.focus();
            }
        });
    </script>
</body>
</html>